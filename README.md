# SWIM (Shear Wave Interference Modulation - 剪切波干涉调制)

Title: `Spatiotemporal Interference of Cutaneous Shear Waves Dictates Tactile Perception in Ultrasonic Haptics`

## 研究目标

研究目标重点并不是单纯简单的提出一种新的调制方式，而是通过实验、仿真和理论分析，来深入的研究在不同调制模式下，效果的差异的根本原因/机理（心理学原因，生理物理学原因等等）。偏底层基础研究（如剪切波传播、马赫锥效应、机械感受器激活），并给出一套新的从表面波传播角度分析和看待的超声触觉形成相关的理论（虽然相关研究已经表明了皮肤表明剪切波传播才是产生触觉更强的主要因素，并且也有研究研究了皮肤表面的表面波的马赫锥会导致触觉扩散模糊，但是仍然缺少一个统一的来指导超声触觉设计的理论）。以及给出从实验结果和形成的理论上分析，想要实现强度更高、精度更高的超声触觉反馈，需要满足的条件。

## 背景信息

### 问题分析

传统的LM调制，虽然通过横向移动超声相控阵焦点，实现触发更多的皮肤受体，结合对焦点移动速度的控制，使得焦点移动速度匹配皮肤表面剪切波波速，从而实现对波前的压缩。通过这两个效应达到了更强的触觉反馈强度。但是这种方法存在触觉反馈精度的问题，焦点超音速（皮肤表面波音速）移动时，会产生马赫锥效应，在皮肤表面扩散开来，导致触觉生成精度差。

### 调制方式设计

我现在有一种离散的超声触觉焦点调制方法，名称为 Discrete Lateral Modulation（DLM）。每个时刻焦点都不进行移动，而是在多个不同位置之间进行瞬间切换。

具体细节为：超声相控阵的聚焦点周期性的在一个圆环上均匀分布的多个离散点之间进行切换，每个周期（例如200Hz的一个周期）内超声聚焦点按顺序在每个聚焦点之间转移，例如我上传的两个图片示意了两个焦点切换和三个焦点切换。当采样的离散点个数趋于无穷个时，这种焦点调制方法等效于圆形轨迹的横向调制（LM_C）。

我还根据LM的论文设计了一种 LM_L 的变体版本 ULM_L (Unidirectional Lateral Modulation (Linear))，聚焦点不是在两个目标点之间来回移动，而是单向的从A点移动到B点，再瞬移到A点继续直线移动到B点。这种调制方式保证了轨迹上每个点受到的刺激频率和轨迹的循环频率保持一致（都是200Hz），不会出现双向的 LM_L 由于每个周期经过轨迹中间每个点两次从而产生的2倍频到400Hz的现象。从而保证了最大程度刺激皮肤受体敏感的频率区间。（可能非原创，其他人应该已经做过了，但是可以用来进行对比试验，作为探针来分析数据和理论）。

### 理论分析

我自己对 DLM、ULM_L、LM_L 和 LM_C 调制的初步分析如下：

- 两点DLM（DLM_2）：当我切换聚焦点的时机足够恰好时，在第一个聚焦点A戳下去，等产生的皮肤表面传播的剪切波刚好传播到B处时，再切换焦点到B点。这样会在B点形成一个很大的压力或者剪切梯度，从而更高效的激活皮肤触觉受体，产生明显的触觉感知。

- 三点DLM（DLM_3）：当离散的聚焦点个数增加到3个及以上时，控制焦点分布的半径，使得每个焦点产生的表面波会在圆心处产生一个旋转变化的剪切应变/应力，这个旋转剪切量旋转的频率正好是调制整体调制频率（200Hz），从而同样可以激活皮肤中对剪切敏感的触觉受体）。

- ULM_L：ULM_L 调制方式的每个周期内，焦点会单向的直线从A点移动到B点移动，焦点移动速度匹配皮肤表面剪切波波速，从而实现对波前的持续压缩。

- LM_L：持续移动的 LM_L 调制方式的焦点会在焦点移动方向前侧产生一个高压区，在焦点移动方向后侧产生一个低压区。当焦点移动到直线线段的两侧两头时，速度方向突然180° 转变，则会让新产生的高压区和之前尾迹的低压区碰撞，产生一个极大的压力或者剪切的梯度，从而同样产生一种很强大的触觉感知。

- LM_C：平滑沿着圆形轨迹移动的焦点在每一时刻都会在皮肤上激发沿着皮肤方向传播的表面剪切波，和DLM类似，这些剪切波也会在圆心处产生旋转剪切场。

### 实验1

#### 实验1设计

由于每种调制刺激模式产生的触觉感知绝对值较弱，导致相对的对比差异也较弱。为了保证能够获取到足够的正确的对比差异，实验设计采用对比式实验范式。

1. 实验阵列与组合
共有5个自变量（$DLM_2$, $DLM_3$, $ULM_L$, $LM_L$, $LM_C$）。
将它们进行两两组合，总共产生 $C(5,2) = 10$ 个比较对（例如：$DLM_2$ vs $LM_C$）。
考虑到呈现顺序的遗留效应（先出现的刺激会被记忆衰减影响），需要引入正反序。每个Block包含20个试次（Trials）（即10个比较对 $\times$ 2次呈现顺序）。

2. 硬件与物理环境控制
听觉遮蔽：被试必须佩戴播放固定歌单的降噪耳机，阻断相控阵开关时产生的轻微次声波或高频噪音泄漏。
固定与耦合：被试的手掌必须放置在一个固定高度的泡沫垫上，控制手掌到超声换能器间的距离和位置固定。

##### 实验流程（按被试进行）

招募 24名 被试进行实验1。实验分为两个独立的Block（模块），分别为“强度比较”模块和“空间精度比较”模块。两个模块的呈现顺序对每个被试进行随机化平衡（例如一半被试先做强度模块，另一半先做精度模块），以消除顺序效应。

- **Block设计与随机化**
  - **Block 1（强度/精度）**：包含20个Trials（10个刺激对组合 $\times$ 2次呈现顺序）。
  - **Block 2（精度/强度）**：重新随机化呈现这20个Trials。
  - **双盲控制**：实验者与被试在实验进行中均不知道当前呈现的是哪两个调制刺激条件。

- **单次试次呈现（Trial Procedure）**
    呈现“刺激A”（持续1.5秒） $\rightarrow$ 停止（持续1.0秒，用于感受野的机械和神经恢复） $\rightarrow$ 呈现“刺激B”（持续1.5秒）。不允许重复播放刺激，让被试通过第一直觉感受进行选择。

- **强制回答任务（2-AFC）**
    被试根据当前Block的任务要求，做出唯一的强制选择（不允许回答“一样”或“不确定”）：
  - **强度模块（Intensity Block）**：“刚才的两个刺激，哪一个的力度/压力更强？A还是B？”
  - **精度模块（Spatial Precision Block）**：“刚才的两个刺激，哪一个的触觉面积更小、更像是一个清晰的点？A还是B？”


#### 实验1参数设置

所有参数均由刺激频率200Hz、皮肤表面波传播波速以5m/s计算。

所有调制方法的轨迹中心点都为 (0, 0, 0.1) m

- DLM_2：选择的圆环半径为 0.625cm
- DLM_3：选择的圆环半径为 0.481cm
- ULM_L：选择的轨迹长度为 2.5cm
- LM_L：选择的起终点距离为 1.25cm，每个周期内轨迹总路程为 2.5cm
- LM_C：选择的圆环半径为 0.398cm

##### 数据处理与理论验证

本研究采用基于贝叶斯推断的混合效应 Bradley-Terry 模型（Bayesian Mixed-Effects Bradley-Terry Model）对成对比较数据进行分析，以评估不同调制方式的主观强度和空间清晰度。

1. **数据预处理**
    - **数据整合**：读取所有被试的实验记录文件（CSV格式），剔除无效试次。
    - **格式转换**：将数据转换为**长格式（Long Format）**。每一行代表一次独立的成对比较（Trial），包含：被试ID（ParticipantID）、刺激A（StimulusA）、刺激B（StimulusB）以及二元选择结果（Outcome，1代表A优于B，0代表B优于A）。
    - **胜率矩阵（Win Matrix）**：生成 $5 \times 5$ 的胜率矩阵，直观展示各调制方式之间的胜负关系。

2. **统计模型构建**
    - **模型框架**：使用基于广义线性混合模型（GLMM）框架的 Bradley-Terry 模型。具体采用 **二项贝叶斯混合 GLM (Binomial Bayes Mixed GLM)** 进行参数估计。
    - **固定效应 (Fixed Effects)**：将5种调制方式（$DLM_2, DLM_3, ULM_L, LM_L, LM_C$）作为固定效应，用于估计每种方式的相对偏好得分（Log-odds Score）。
    - **随机效应 (Random Effects)**：将被试ID（ParticipantID）作为随机效应（Random Intercept），以解释不同被试在感知基准或判断标准上的个体差异（Subject Heterogeneity）。
    - **评分标准化**：模型输出的原始系数（Coefficients）经过中心化处理（Zero-centered），使得所有方法的平均得分为 0，便于直观比较相对优劣。

3. **统计检验与推断**
    - **成对比较 (Pairwise Comparisons)**：基于模型参数的协方差矩阵（Covariance Matrix），使用 **Wald 检验 (Wald Test)** 计算任意两种调制方式之间评分差异的 Z分数（Z-score）和 p值（p-value）。
    - **显著性水平**：
        - *** : p < 0.001
        - ** : p < 0.01
        - - : p < 0.05
        - n.s.: 无显著差异 (p ≥ 0.05)

4. **决策时间分析 (Decision Time Analysis)**
    - **目的**：评估不同刺激对之间的辨别难度（Discriminability）。较长的反应时通常意味着两个刺激的主观差异较小，难以区分。
    - **预处理**：
        - **无效数据剔除**：剔除过短（< 200ms）或过长（> 10s）的异常反应时数据。
        - **对数变换 (Log-transformation)**：对原始反应时进行自然对数变换，以校正反应时数据的偏态分布，使其更符合正态假设。
        - **Z-score 标准化 (Z-score Standardization)**：对每个被试的对数反应时（Log-RT）进行标准化处理（减去均值除以标准差），以消除不同被试基础反应速度的个体差异（Baseline Differences）。
    - **指标计算**：计算每对刺激组合的平均标准化对数反应时（Mean Z-Log-RT），构建反应时矩阵。

5. **结果可视化**
    - **相对评分条形图**：展示各调制方式在“主观强度”和“空间清晰度”上的相对表现（Log-odds 尺度）。
        - **误差棒**：展示 **95% 置信区间 (95% CI)**，计算公式为 $\pm 1.96 \times SE$。
        - **显著性标注**：使用连接线和星号标注具有统计学显著性差异的对比对。
    - **决策时间热力图**：使用热力图（Heatmap）展示各刺激对之间的平均标准化决策时间（Z-Log-RT）。颜色越深代表决策时间越长，区分难度越大。


#### 预实验结果

基于 Bradley-Terry (BT) 模型对成对比较数据进行分析，结果如下：

**1. 强度感知 (Intensity Preference)**

- **评分排序**: ULM_L 得分最高 (1.01)，表现显著优于其他方法。其次是 DLM_2 (0.23)，其余方法得分较低 (LM_C: -0.19, DLM_3: -0.30, LM_L: -0.74)。
- **显著性差异 (Wald Test)**:
  - **ULM_L vs. 其他**: ULM_L 显著优于 LM_C (p=0.013, \*), DLM_3 (p=0.007, \*\*), 和 LM_L (p=0.0005, \*\*\*)。
  - **DLM_2 vs. LM_L**: DLM_2 显著优于 LM_L (p=0.045, \*)。
- **结论**: ULM_L 在呈现强度信息方面表现最佳，且显著优于大多数基准方法。

**2. 空间清晰度 (Spatial Clarity Preference)**

- **评分排序**: LM_L 得分最高 (0.50)，其次是 LM_C (0.09)，ULM_L 得分最低 (-0.27)。
- **显著性差异**: 各方法之间未发现统计学上的显著差异 (所有 p > 0.05)。虽然 LM_L 与 ULM_L 之间存在一定差距 (p=0.08)，但并未达到显著性水平。
- **结论**: 各种方法在空间清晰度方面表现较为接近，LM_L 略占优势但无统计学意义。


其他结果：

1. DLM_2 和 DLM_3 产生的可以被人的听觉接收到的载波噪声明显比LM_L和LM_C更大一些。
2. DLM_3 的低频噪声频率明显比DLM_2更高一些，可能由于一个周期内多个离散点切换会导致倍频。（同样倍频可能也会影响触觉生成，例如 DLM_3 在圆心处会产生 方向以200Hz的旋转剪切，但是剪切强度信号频率可能会由于200Hz内的每个周期刺激三次从而变成600Hz的触觉受体不敏感的频率范围内）。
3. LM_C 的低频（200Hz）可听噪声几乎为0（可能由于LM_C的焦点轨迹最平滑，既没有速度大小突变（例如DLM），也没有速度方向突变（例如LM_L）。






